# ğŸ¤ Contributing to Ora Admin Portal

Thank you for your interest in contributing to Ora! This guide will help you get started.

## ğŸ“‹ Table of Contents

- [Code of Conduct](#code-of-conduct)
- [Getting Started](#getting-started)
- [Development Workflow](#development-workflow)
- [Issue Guidelines](#issue-guidelines)
- [Pull Request Process](#pull-request-process)
- [Coding Standards](#coding-standards)
- [Testing Requirements](#testing-requirements)
- [AI-Assisted Development](#ai-assisted-development)

## ğŸ“œ Code of Conduct

This project follows a code of conduct. By participating, you are expected to:

- Be respectful and inclusive
- Accept constructive criticism
- Focus on what is best for the community
- Show empathy towards other contributors

## ğŸš€ Getting Started

### Prerequisites

- Node.js 20+ and npm
- Firebase account with a project configured
- Git installed
- (Optional) Claude Code for AI-assisted development

### Setup

1. **Fork and clone the repository**

```bash
git clone https://github.com/YOUR_USERNAME/OraWebApp.git
cd OraWebApp
```

2. **Install dependencies**

```bash
npm install
```

3. **Configure environment**

```bash
cp .env.example .env
# Edit .env with your Firebase credentials
```

4. **Start development server**

```bash
npm run dev
```

Visit [http://localhost:3000](http://localhost:3000)

## ğŸ”„ Development Workflow

We follow a **spec-driven, AI-assisted** development workflow:

### 1. Create or Find an Issue

- Browse [existing issues](https://github.com/Chrisdesmurger/OraWebApp/issues)
- Create a new issue using our templates:
  - ğŸš€ **Feature Request** - For new features
  - ğŸ› **Bug Report** - For bugs
  - ğŸ“‹ **Technical Spec** - For detailed specs

### 2. Wait for Spec Generation (Features Only)

For feature requests with the `spec-needed` label:

- GitHub Actions will automatically trigger the **Spec Assistant**
- Claude Code will analyze the codebase and generate a technical specification
- The spec will be posted as a comment on the issue
- Review and refine the spec with maintainers

### 3. Get Assigned

- Comment on the issue expressing interest
- Wait for a maintainer to assign it to you
- Issues labeled `good first issue` are great for beginners

### 4. Create a Branch

```bash
# For features
git checkout -b feat/short-description

# For bug fixes
git checkout -b fix/short-description

# For docs
git checkout -b docs/short-description
```

### 5. Make Changes

- Follow the [coding standards](#coding-standards)
- Write tests for new functionality
- Update documentation as needed
- Commit using [conventional commits](#commit-message-format)

### 6. Test Your Changes

```bash
# Run all checks
npm run type-check  # TypeScript
npm run lint        # ESLint
npm test            # Vitest unit tests
npm run test:e2e    # Playwright E2E tests
npm run build       # Production build
```

### 7. Push and Create PR

```bash
git push origin feat/your-feature-name
```

- Open a Pull Request on GitHub
- Fill out the PR template completely
- Link the related issue (`Closes #123`)
- Wait for CI checks to pass
- Wait for review from maintainers

### 8. Address Review Feedback

- Make requested changes
- Push new commits (don't force-push during review)
- Re-request review when ready

### 9. Merge

- Maintainers will merge your PR once approved
- Your contribution will be included in the next release!

## ğŸ“ Issue Guidelines

### Creating Issues

Use the appropriate template:

#### ğŸš€ Feature Request

```markdown
Required fields:
- Context & Motivation
- User Story (As a... I want... So that...)
- Acceptance Criteria (Gherkin format)
- Priority (P0-P3)
- Estimated Complexity (XS-XL)
```

#### ğŸ› Bug Report

```markdown
Required fields:
- Bug Description
- Steps to Reproduce
- Expected vs Actual Behavior
- Error Message / Console Output
- Severity (Critical/High/Medium/Low)
- Frequency (Always/Often/Sometimes/Rarely/Once)
```

#### ğŸ“‹ Technical Spec

```markdown
Required fields:
- Overview
- Architecture & Design
- API Contracts
- Data Models
- Security Considerations
- Testing Strategy
```

### Issue Labels

- `feature` - New feature request
- `bug` - Bug report
- `spec-needed` - Needs technical specification (triggers AI)
- `spec-generated` - Spec generated by AI
- `spec-approved` - Spec approved, ready for implementation
- `good first issue` - Good for newcomers
- `help wanted` - Extra attention needed
- `priority: critical` - Urgent
- `status: in-progress` - Being worked on
- `status: blocked` - Blocked by dependency

## ğŸ”€ Pull Request Process

### Before Creating a PR

1. âœ… All tests pass locally
2. âœ… Code follows style guidelines
3. âœ… New code has tests
4. âœ… Documentation is updated
5. âœ… No console errors or warnings
6. âœ… Commits follow conventional format

### PR Requirements

- **Title**: Use conventional commit format (`feat: Add bulk upload`, `fix: CORS error`)
- **Description**: Complete the PR template
- **Tests**: Add unit and/or E2E tests
- **Documentation**: Update relevant docs
- **CI**: All GitHub Actions must pass
- **Review**: At least 1 approval from maintainer

### CI Checks

Your PR will automatically run:

- âœ… TypeScript type checking
- âœ… ESLint linting
- âœ… Vitest unit tests
- âœ… Playwright E2E tests
- âœ… Next.js build
- âœ… Security audit (CodeQL)
- ğŸ¤– AI test analysis (on failures)

If tests fail, Claude Code will analyze the failures and post suggestions as a comment.

### Review Process

1. **Automated Review**: GitHub Actions runs all checks
2. **AI Analysis**: Claude Code may review and suggest improvements
3. **Human Review**: Maintainer reviews code, design, tests
4. **Feedback**: Address any requested changes
5. **Approval**: Once approved, maintainer will merge

### Merge Strategy

- We use **squash and merge** for clean history
- Your commits will be squashed into one
- The PR title becomes the commit message
- Use a clear, conventional commit title

## ğŸ’» Coding Standards

### TypeScript

- **Strict mode**: All code must pass `strict: true`
- **No `any`**: Use proper types or `unknown`
- **Interfaces over types**: Prefer `interface` for objects
- **Explicit return types**: For functions

```typescript
// âœ… Good
interface User {
  id: string;
  email: string;
}

function getUser(id: string): Promise<User> {
  // ...
}

// âŒ Bad
type User = { id: string; email: string };

function getUser(id: string) {
  // Missing return type
}
```

### React/Next.js

- **Functional components**: Use hooks, not classes
- **TypeScript**: All components typed with `FC` or explicit props
- **Server Components**: Default to server components (Next.js 15)
- **Client Components**: Use `"use client"` only when needed

```tsx
// âœ… Server Component (default)
export default function UsersPage() {
  return <div>Users</div>;
}

// âœ… Client Component (when needed)
"use client";
import { useState } from "react";

export default function Counter() {
  const [count, setCount] = useState(0);
  return <button onClick={() => setCount(count + 1)}>{count}</button>;
}
```

### Naming Conventions

- **Files**: `kebab-case.tsx`, `UserProfile.tsx` (components)
- **Components**: `PascalCase`
- **Functions**: `camelCase`
- **Constants**: `UPPER_SNAKE_CASE`
- **Interfaces**: `PascalCase` (no `I` prefix)

### File Structure

```
app/
â”œâ”€â”€ admin/
â”‚   â”œâ”€â”€ users/
â”‚   â”‚   â”œâ”€â”€ page.tsx          # Users page
â”‚   â”‚   â””â”€â”€ _components/      # Page-specific components
â”‚   â”‚       â””â”€â”€ UserTable.tsx
â”‚   â””â”€â”€ layout.tsx
components/
â”œâ”€â”€ ui/                        # shadcn/ui components
â”‚   â””â”€â”€ button.tsx
â””â”€â”€ charts/                    # Recharts components
    â””â”€â”€ BarChart.tsx
lib/
â”œâ”€â”€ firebase/                  # Firebase utilities
â”‚   â”œâ”€â”€ admin.ts              # Admin SDK
â”‚   â””â”€â”€ client.ts             # Client SDK
â””â”€â”€ api/                       # API utilities
    â””â”€â”€ auth-middleware.ts
```

### Commit Message Format

We use [Conventional Commits](https://www.conventionalcommits.org/):

```
<type>(<scope>): <description>

[optional body]

[optional footer]
```

**Types**:

- `feat`: New feature
- `fix`: Bug fix
- `docs`: Documentation
- `style`: Formatting (no code change)
- `refactor`: Code refactoring
- `perf`: Performance improvement
- `test`: Tests
- `chore`: Maintenance

**Examples**:

```bash
feat(upload): Add bulk lesson upload
fix(cors): Resolve CORS error for resumable uploads
docs(readme): Update Firebase setup guide
refactor(api): Extract auth middleware
test(users): Add E2E test for user creation
```

## ğŸ§ª Testing Requirements

### Unit Tests (Vitest)

- **Coverage**: Aim for >80% on new code
- **Location**: `tests/unit/`
- **Run**: `npm test`

```typescript
import { describe, it, expect } from 'vitest';

describe('validateEmail', () => {
  it('should accept valid email', () => {
    expect(validateEmail('test@example.com')).toBe(true);
  });

  it('should reject invalid email', () => {
    expect(validateEmail('invalid')).toBe(false);
  });
});
```

### E2E Tests (Playwright)

- **Coverage**: Critical user flows
- **Location**: `tests/e2e/`
- **Run**: `npm run test:e2e`

```typescript
import { test, expect } from '@playwright/test';

test('create lesson flow', async ({ page }) => {
  await page.goto('/admin/content');
  await page.click('text=Create Lesson');
  await page.fill('[name="title"]', 'Test Lesson');
  await page.click('button:has-text("Create")');

  await expect(page.locator('text=Test Lesson')).toBeVisible();
});
```

### Test Coverage Requirements

| Change Type      | Unit Tests | E2E Tests   | Required Coverage |
| ---------------- | ---------- | ----------- | ----------------- |
| New feature      | âœ… Yes     | âœ… Yes      | >80%              |
| Bug fix          | âœ… Yes     | âš ï¸ Optional | >70%              |
| Refactoring      | âœ… Yes     | âŒ No       | Maintain existing |
| Documentation    | âŒ No      | âŒ No       | N/A               |
| Security fix     | âœ… Yes     | âœ… Yes      | 100%              |
| Performance      | âœ… Yes     | âš ï¸ Optional | >80%              |

## ğŸ¤– AI-Assisted Development

We use **Claude Code** to accelerate development while maintaining quality.

### How AI Helps

1. **Spec Generation**: AI reads issues and generates technical specs
2. **Test Analysis**: AI analyzes failed tests and suggests fixes
3. **Code Review**: AI can review PRs for common issues
4. **Documentation**: AI helps generate and update docs

### Human-in-the-Loop

âš ï¸ **Important**: AI is an assistant, not a replacement

- âœ… AI generates **suggestions** â†’ Humans **review and decide**
- âœ… AI writes **drafts** â†’ Humans **refine and approve**
- âœ… AI finds **issues** â†’ Humans **fix and verify**

**Never**:

- âŒ Blindly merge AI-generated code without review
- âŒ Deploy AI changes without testing
- âŒ Trust AI for security-critical decisions

### Using Claude Code

If you have Claude Code access:

```bash
# Start Claude Code agent
claude-code

# Ask for help
> Help me implement the bulk upload feature from issue #123

# Review AI-generated code
> Review the changes in CreateLessonDialog.tsx

# Generate tests
> Generate unit tests for the uploadFile function
```

## ğŸ¯ What to Contribute

### Good First Issues

Look for issues labeled `good first issue`:

- Documentation improvements
- Small bug fixes
- UI polish
- Test additions

### High-Impact Areas

- **Performance**: Optimize slow queries, reduce bundle size
- **Accessibility**: WCAG compliance, keyboard navigation
- **Tests**: Increase coverage, add E2E scenarios
- **Documentation**: User guides, API docs, ADRs
- **Security**: Firestore rules, input validation

### Out of Scope

- Major architectural changes (discuss first)
- Breaking changes (require RFC)
- Third-party integrations (need approval)

## ğŸ“ Getting Help

- **Questions**: Open a [Discussion](https://github.com/Chrisdesmurger/OraWebApp/discussions)
- **Bugs**: Open an [Issue](https://github.com/Chrisdesmurger/OraWebApp/issues/new/choose)
- **Chat**: Join our community (link TBD)

## ğŸ“„ License

By contributing, you agree that your contributions will be licensed under the MIT License.

---

**Thank you for contributing to Ora! ğŸ™**

<sub>Built with â¤ï¸ using Claude Code</sub>
